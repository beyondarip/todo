import{_ as J,c as _,B as O,r as l,a as W,C as Z,o as ee,I as te,i as f,g as F,h as t,w as S,d as ae,j as N,k as R,M as se,F as oe,u as re,e as ne,f as u,b as P,s as le,x as de,q as ie,t as y,z as ue,y as M}from"./index-B8Wi_BLM.js";import{_ as ce}from"./PageHeader-BNyDcRJ5.js";import{u as ve}from"./flashcards-CQH5aUie.js";import{s as q}from"./sections-D1Gc3Eyc.js";const ge={key:2,class:"flex flex-col space-y-6"},fe={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-4"},ye={class:"flex items-center justify-between mb-2"},he={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},be={class:"text-sm text-gray-500 dark:text-gray-400"},ke={class:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5"},xe={class:"perspective flex-grow"},me={class:"flashcard-face flashcard-front bg-white dark:bg-gray-800 shadow rounded-lg p-6 flex flex-col"},we={class:"flex items-center justify-between mb-4"},pe={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},_e={class:"text-xl font-bold text-gray-900 dark:text-white mb-4"},Se={class:"flex-grow text-gray-700 dark:text-gray-300 text-lg"},Ce={class:"flashcard-face flashcard-back bg-gradient-to-br from-primary-600 to-secondary-600 text-white shadow rounded-lg p-6 flex flex-col"},$e={class:"flex-grow overflow-auto"},Ie={class:"markdown-body text-white"},Fe=["innerHTML"],Ne={key:1,class:"flex justify-between bg-white dark:bg-gray-800 shadow rounded-lg p-4"},Me=["disabled"],Ee={key:2,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"},Te={class:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full p-6 m-4"},Ae={class:"mb-6"},De={class:"text-gray-700 dark:text-gray-300 mb-4"},Ve={class:"fixed bottom-4 right-4 bg-white dark:bg-gray-800 shadow-lg rounded-lg p-3 text-sm text-gray-600 dark:text-gray-300 opacity-70 hover:opacity-100 transition-opacity duration-200"},je={key:0,class:"mt-2 space-y-1"},ze={__name:"StudySession",setup(Be){const E=O(),d=_(()=>E.query.section),h=l(""),C=l(!1),i=_(()=>E.query.tag),m=l(""),T=a=>{if(!(a.target.tagName==="INPUT"||a.target.tagName==="TEXTAREA"))switch(a.key){case" ":a.preventDefault(),I();break;case"ArrowRight":o.value||z();break;case"ArrowLeft":o.value||B();break;case"1":o.value&&v(1);break;case"2":o.value&&v(2);break;case"3":o.value&&v(3);break;case"4":o.value&&v(4);break;case"r":case"R":x.value&&H();break;case"s":case"S":o.value||p();break;case"Escape":x.value?L():confirm("Are you sure you want to exit this study session?")&&A.push("/flashcards");break}},A=re(),D=ve(),V=l(!0),s=l([]),k=l([]),r=l(0),o=l(!1),x=l(!1),w=l(null),$=l(0),j=W([]),c=l(null),b=_(()=>s.value[r.value]||{}),K=_(()=>b.value.additional_content?Z(b.value.additional_content):"");ee(async()=>{try{await Promise.all([G(),Y()]),Q(),window.addEventListener("keydown",T)}catch(a){console.error("Error initializing study session:",a)}finally{V.value=!1}}),te(()=>{c.value&&clearInterval(c.value),window.removeEventListener("keydown",T)});const G=async()=>{try{const a={page_size:100};if(d.value){const e=parseInt(d.value,10)||d.value;a.section=e,console.log(`Filtering by section: ${e}`)}if(i.value){const e=parseInt(i.value,10)||i.value;a.tag=e,console.log(`Filtering by tag: ${e}`)}await D.fetchFlashcards(1,a),s.value=[...D.flashcards],console.log(`Loaded ${s.value.length} flashcards`),await U(),s.value.length>0&&p()}catch(a){console.error("Failed to load flashcards:",a)}},U=async()=>{try{if(k.value.length===0){const a=await q.getSections();k.value=a.data.results}if(d.value){const a=parseInt(d.value,10)||d.value,e=k.value.find(n=>n.id===a);e?(h.value=e.title,console.log(`Found section name: ${h.value}`)):console.warn(`Could not find section with ID: ${a}`)}if(i.value){const a=await tagsService.getTags(),e=parseInt(i.value,10)||i.value,n=a.data.results.find(g=>g.id===e);n?(m.value=n.name,console.log(`Found tag name: ${m.value}`)):console.warn(`Could not find tag with ID: ${e}`)}}catch(a){console.error("Error loading section/tag info:",a)}},Y=async()=>{try{const a=await q.getSections();k.value=a.data.results}catch(a){console.error("Failed to load sections:",a)}},Q=()=>{w.value=new Date,c.value=setInterval(()=>{$.value=Math.floor((new Date-w.value)/1e3)},1e3)},I=()=>{o.value=!o.value},z=()=>{o.value=!1,r.value<s.value.length-1?r.value++:(x.value=!0,c.value&&clearInterval(c.value))},B=()=>{r.value>0&&r.value--},v=a=>{const e=`.rating-button-${a}`,n=document.querySelector(e);n&&(n.classList.add("key-highlight"),setTimeout(()=>{n.classList.remove("key-highlight")},300)),j[r.value]=a,z()},p=()=>{for(let a=s.value.length-1;a>0;a--){const e=Math.floor(Math.random()*(a+1));[s.value[a],s.value[e]]=[s.value[e],s.value[a]]}r.value=0,j.length=0},H=()=>{x.value=!1,p(),w.value=new Date,$.value=0,c.value&&clearInterval(c.value),c.value=setInterval(()=>{$.value=Math.floor((new Date-w.value)/1e3)},1e3)},L=()=>{window.location.href=window.location.origin+"/flashcards"},X=a=>{const e=k.value.find(n=>n.id===a);return e?e.title:""};return(a,e)=>{const n=ne("router-link");return u(),f(oe,null,[F(ae,{title:"Study Session"},{default:S(()=>[F(ce,{title:d.value?`Study: ${h.value}`:i.value?`Study: #${m.value}`:"Study Session"},{actions:S(()=>[F(n,{to:"/flashcards",class:"btn bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 shadow-sm"},{default:S(()=>e[6]||(e[6]=[R(" Exit Session ")])),_:1})]),_:1},8,["title"]),V.value?(u(),P(le,{key:0})):s.value.length===0?(u(),P(de,{key:1,title:d.value?`No flashcards in ${h.value}`:i.value?`No flashcards with tag #${m.value}`:"No flashcards available",message:d.value||i.value?"There are no flashcards matching your criteria. Create some or choose another filter.":"You need to create some flashcards before you can start a study session.","action-text":"Create Flashcards",onAction:e[0]||(e[0]=g=>ie(A).push("/flashcards/new"))},{icon:S(()=>e[7]||(e[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)])),_:1},8,["title","message"])):(u(),f("div",ge,[t("div",fe,[t("div",ye,[t("h3",he," Progress: "+y(r.value+1)+" of "+y(s.value.length),1),t("div",be,y(Math.round((r.value+1)/s.value.length*100))+"% ",1)]),t("div",ke,[t("div",{class:"bg-gradient-to-r from-primary-500 to-secondary-500 h-2.5 rounded-full",style:ue({width:`${(r.value+1)/s.value.length*100}%`})},null,4)])]),t("div",xe,[t("div",{class:M(["flashcard-study",{flipped:o.value}]),onClick:I},[t("div",me,[t("div",we,[e[8]||(e[8]=t("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"}," Question ",-1)),b.value.section?(u(),f("div",pe,y(X(b.value.section)),1)):N("",!0)]),t("h3",_e,y(b.value.title),1),t("div",Se,y(b.value.content),1),e[9]||(e[9]=t("div",{class:"mt-6 text-center text-sm text-gray-500 dark:text-gray-400"}," Click to reveal answer ",-1))]),t("div",Ce,[e[10]||(e[10]=t("div",{class:"flex items-center justify-between mb-4"},[t("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white/20 text-white"}," Answer ")],-1)),t("div",$e,[t("div",Ie,[t("div",{innerHTML:K.value},null,8,Fe)])]),e[11]||(e[11]=t("div",{class:"mt-6 text-center text-sm text-white/70"}," How well did you know this? ",-1))])],2)]),o.value?(u(),f("div",{key:0,class:M(["grid grid-cols-4 gap-4 bg-white dark:bg-gray-800 shadow rounded-lg p-4",{"animate-fade-in":o.value}])},[t("button",{onClick:e[1]||(e[1]=g=>v(1)),class:"rating-button-1 py-3 px-4 rounded-lg bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300 font-medium hover:bg-red-200 dark:hover:bg-red-900/50 transition-colors duration-200"}," Didn't Know "),t("button",{onClick:e[2]||(e[2]=g=>v(2)),class:"rating-button-2 py-3 px-4 rounded-lg bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300 font-medium hover:bg-orange-200 dark:hover:bg-orange-900/50 transition-colors duration-200"}," Hard "),t("button",{onClick:e[3]||(e[3]=g=>v(3)),class:"rating-button-3 py-3 px-4 rounded-lg bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300 font-medium hover:bg-yellow-200 dark:hover:bg-yellow-900/50 transition-colors duration-200"}," Good "),t("button",{onClick:e[4]||(e[4]=g=>v(4)),class:"rating-button-4 py-3 px-4 rounded-lg bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 font-medium hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors duration-200"}," Easy ")],2)):(u(),f("div",Ne,[t("button",{onClick:B,class:M(["px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-200",{"opacity-50 cursor-not-allowed":r.value===0}]),disabled:r.value===0}," Previous ",10,Me),t("button",{onClick:p,class:"px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors duration-200"}," Shuffle "),t("button",{onClick:I,class:"px-4 py-2 rounded-lg bg-primary-600 text-white hover:bg-primary-700 transition-colors duration-200"}," Show Answer ")])),x.value?(u(),f("div",Ee,[t("div",Te,[e[12]||(e[12]=t("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-4"},"Session Complete!",-1)),t("div",Ae,[t("p",De," You've completed your study session"+y(h.value?` on ${h.value}`:"")+". Here's how you did: ",1)]),t("div",{class:"flex justify-end space-x-3"},[t("button",{onClick:H,class:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}," Restart Session "),t("button",{onClick:L,class:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700"}," Finish ")])])])):N("",!0)]))]),_:1}),t("div",Ve,[t("button",{onClick:e[5]||(e[5]=g=>C.value=!C.value),class:"flex items-center"},e[13]||(e[13]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1),R(" Keyboard Shortcuts ")])),C.value?(u(),f("div",je,e[14]||(e[14]=[se("<div data-v-06d8e245><kbd data-v-06d8e245>Space</kbd> - Flip card</div><div data-v-06d8e245><kbd data-v-06d8e245>→</kbd> - Next card</div><div data-v-06d8e245><kbd data-v-06d8e245>←</kbd> - Previous card</div><div data-v-06d8e245><kbd data-v-06d8e245>1</kbd> - Didn&#39;t know</div><div data-v-06d8e245><kbd data-v-06d8e245>2</kbd> - Hard</div><div data-v-06d8e245><kbd data-v-06d8e245>3</kbd> - Good</div><div data-v-06d8e245><kbd data-v-06d8e245>4</kbd> - Easy</div><div data-v-06d8e245><kbd data-v-06d8e245>R</kbd> - Restart session</div><div data-v-06d8e245><kbd data-v-06d8e245>S</kbd> - Shuffle cards</div><div data-v-06d8e245><kbd data-v-06d8e245>Esc</kbd> - Exit session</div>",10)]))):N("",!0)])],64)}}},qe=J(ze,[["__scopeId","data-v-06d8e245"]]);export{qe as default};
