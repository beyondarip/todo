import{_ as Q,r as n,c as h,B as G,a as O,G as X,C as Y,o as J,I as W,b as P,w as U,d as Z,u as tt,f as o,g as et,i as l,h as e,q as b,s as at,A as rt,j as w,F as _,m as F,k as i,t as d,l as y,p as C,v as st,z as ot,y as lt,E as z}from"./index-C4Um7Kjq.js";import{_ as it}from"./PageHeader-Czcs01bb.js";import{u as nt,f as I}from"./flashcards-DPp1VuaB.js";import{s as dt}from"./sections-BygJVMTa.js";import{t as ct}from"./tags-SncAe3P9.js";const ut={key:1,class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},gt={key:0,class:"bg-red-50 dark:bg-red-900/30 text-red-800 dark:text-red-200 p-4 rounded-md"},yt={key:0},ft={key:1},pt={class:"mt-1"},xt={class:"mt-1"},vt={class:"mt-1"},mt={class:"border border-gray-200 dark:border-gray-700 rounded-lg p-4"},kt={class:"flex items-center justify-between mb-4"},bt={class:"h-48 overflow-y-auto bg-gray-50 dark:bg-gray-900 rounded-lg p-4"},ht={key:0},wt={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},_t={class:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap"},Ft={key:1},Ct={class:"markdown-body"},Et=["innerHTML"],Nt={class:"mt-1"},St=["value"],At={class:"flex flex-wrap gap-2"},Tt=["onClick"],Mt={class:"text-xs opacity-70"},Bt={class:"flex items-center space-x-6"},Lt={class:"flex items-center"},Rt={class:"flex items-center"},Dt={class:"pt-4 flex justify-between space-x-3 border-t border-gray-200 dark:border-gray-700"},Vt={class:"flex space-x-3"},$t=["disabled"],Pt={key:0,class:"flex items-center"},Ut={key:1},zt={__name:"FlashcardForm",setup(It){const m=tt(),E=G(),f=nt(),k=n(!0),c=n(null),N=n([]),p=n([]),g=n(!1),S=n(null),A=n(null),T=n(null),M=n(null);n([]);const x=h(()=>E.params.id),u=h(()=>!!x.value),s=O({title:"",content:"",additional_content:"",section:null,tag_ids:[],is_favorite:!1,is_archived:!1});X(()=>E.params.id,async(a,t)=>{if(a&&a!==t){k.value=!0;try{await D()}catch(r){console.error("Failed to load flashcard after navigation:",r),c.value="Failed to load flashcard details"}finally{k.value=!1}}});const j=h(()=>s.additional_content?Y(s.additional_content):'<p class="text-gray-500 dark:text-gray-400">Answer content will appear here</p>'),q=a=>({1:S,2:A,3:T,4:M})[a],B=async()=>{if(u.value)try{const a=await I.getPreviousFlashcard(x.value);m.push(`/flashcards/${a.data.id}/edit`)}catch(a){console.error("No previous flashcard found:",a)}},L=async()=>{if(u.value)try{const a=await I.getNextFlashcard(x.value);m.push(`/flashcards/${a.data.id}/edit`)}catch(a){console.error("No next flashcard found:",a)}},R=async a=>{if(a.ctrlKey&&a.key==="Enter"){a.preventDefault(),$();return}if(a.key==="Escape"){document.activeElement&&document.activeElement!==document.body&&(document.activeElement.blur(),document.body.focus());return}if(a.target.tagName==="INPUT"||a.target.tagName==="TEXTAREA"||a.target.tagName==="SELECT")return;const t=parseInt(a.key);if(!isNaN(t)&&t>=1&&t<=9){if(a.preventDefault(),t<=5){const r=q(t);r!=null&&r.value&&r.value.focus()}else if(t>=6&&t<=14&&p.value.length>=t-5){const r=t-6;r<p.value.length&&V(p.value[r])}}a.key==="ArrowLeft"?(a.preventDefault(),await B()):a.key==="ArrowRight"&&(a.preventDefault(),await L()),a.key.toLowerCase()==="f"&&(a.preventDefault(),s.is_favorite=!s.is_favorite),a.key.toLowerCase()==="a"&&(a.preventDefault(),s.is_archived=!s.is_archived),a.key.toLowerCase()==="p"&&(a.preventDefault(),g=!g)};J(async()=>{try{await Promise.all([H(),K(),D()]),document.addEventListener("keydown",R)}catch(a){console.error("Error initializing form:",a),c.value="Failed to load form data. Please try again."}finally{k.value=!1}}),W(()=>{document.removeEventListener("keydown",R)});const H=async()=>{try{const a=await dt.getSections();N.value=a.data.results}catch(a){console.error("Failed to load sections:",a)}},K=async()=>{try{const a=await ct.getTags();p.value=a.data.results}catch(a){console.error("Failed to load tags:",a)}},D=async()=>{var a;if(u.value)try{const t=await f.fetchFlashcardById(x.value);s.title=t.title,s.content=t.content||"",s.additional_content=t.additional_content||"",s.section=((a=t.section)==null?void 0:a.id)||t.section||null,s.is_favorite=t.is_favorite||!1,s.is_archived=t.is_archived||!1,t.tags&&Array.isArray(t.tags)&&(s.tag_ids=t.tags.map(r=>r.id))}catch(t){console.error("Failed to load flashcard:",t),c.value="Failed to load flashcard details"}},V=a=>{const t=s.tag_ids.indexOf(a.id);t===-1?s.tag_ids.push(a.id):s.tag_ids.splice(t,1)},$=async()=>{var a;c.value=null;try{const t={title:s.title,front:s.content,back:s.additional_content,section:s.section,tag_ids:s.tag_ids,is_favorite:s.is_favorite,is_archived:s.is_archived,type:"flashcard"};let r;u.value?r=await f.updateFlashcard(x.value,t):r=await f.createFlashcard(t),window.location.reload()}catch(t){console.error("Failed to save flashcard:",t),c.value=((a=t.response)==null?void 0:a.data)||"Failed to save flashcard. Please try again."}};return(a,t)=>(o(),P(Z,{title:u.value?"Edit Flashcard":"New Flashcard"},{default:U(()=>[et(it,{title:u.value?"Edit Flashcard":"New Flashcard"},{actions:U(()=>[e("button",{onClick:t[0]||(t[0]=r=>b(m).back()),class:"btn bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 shadow-sm"}," Cancel ")]),_:1},8,["title"]),k.value?(o(),P(at,{key:0})):(o(),l("div",ut,[e("form",{onSubmit:rt($,["prevent"]),class:"p-6 space-y-6"},[c.value?(o(),l("div",gt,[typeof c.value=="object"?(o(),l("p",yt,[(o(!0),l(_,null,F(c.value,(r,v)=>(o(),l("span",{key:v},[i(d(v)+": "+d(Array.isArray(r)?r.join(", "):r),1),t[9]||(t[9]=e("br",null,null,-1))]))),128))])):(o(),l("p",ft,d(c.value),1))])):w("",!0),t[24]||(t[24]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400 p-3 bg-gray-50 dark:bg-gray-700/30 rounded-lg"},[e("p",{class:"font-medium mb-1"},"Keyboard Shortcuts:"),e("div",{class:"grid grid-cols-2 gap-2"},[e("div",null,[e("span",{class:"inline-block px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 font-mono"},"1-4"),e("span",{class:"ml-2"},"Focus form fields")]),e("div",null,[e("span",{class:"inline-block px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 font-mono"},"←/→"),e("span",{class:"ml-2"},"Previous/Next flashcard")]),e("div",null,[e("span",{class:"inline-block px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-gray-700 dark:text-gray-300 font-mono"},"Ctrl+Enter"),e("span",{class:"ml-2"},"Save flashcard")])])],-1)),e("div",null,[t[10]||(t[10]=e("label",{for:"title",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[i(" Title "),e("span",{class:"text-red-500"},"*"),i(),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"(1)")],-1)),e("div",pt,[y(e("input",{id:"title",ref_key:"titleRef",ref:S,"onUpdate:modelValue":t[1]||(t[1]=r=>s.title=r),type:"text",required:"",class:"input focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:"Flashcard title"},null,512),[[C,s.title]])])]),e("div",null,[t[11]||(t[11]=e("label",{for:"front",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[i(" Front (Question) "),e("span",{class:"text-red-500"},"*"),i(),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"(2)")],-1)),e("div",xt,[y(e("textarea",{id:"front",ref_key:"frontRef",ref:A,"onUpdate:modelValue":t[2]||(t[2]=r=>s.content=r),rows:"5",required:"",class:"input focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:"Question or front side content"},null,512),[[C,s.content]])])]),e("div",null,[t[12]||(t[12]=e("label",{for:"back",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[i(" Back (Answer) "),e("span",{class:"text-red-500"},"*"),i(),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"(3)")],-1)),e("div",vt,[y(e("textarea",{id:"back",ref_key:"backRef",ref:T,"onUpdate:modelValue":t[3]||(t[3]=r=>s.additional_content=r),rows:"5",required:"",class:"input focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:"Answer or back side content (supports Markdown)"},null,512),[[C,s.additional_content]])]),t[13]||(t[13]=e("p",{class:"mt-1 text-xs text-gray-500 dark:text-gray-400"}," You can use Markdown for formatting. Example: **bold**, *italic*, [link](url), etc. ",-1))]),e("div",mt,[e("div",kt,[t[14]||(t[14]=e("h3",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Preview",-1)),e("button",{type:"button",onClick:t[4]||(t[4]=r=>g.value=!g.value),class:"text-xs px-2 py-1 rounded bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"},d(g.value?"Show Question":"Show Answer"),1)]),e("div",bt,[g.value?(o(),l("div",Ft,[e("div",Ct,[e("div",{innerHTML:j.value},null,8,Et)])])):(o(),l("div",ht,[e("h4",wt,d(s.title||"Flashcard Title"),1),e("div",_t,d(s.content||"Front side content will appear here"),1)]))])]),e("div",null,[t[16]||(t[16]=e("label",{for:"section",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[i(" Section "),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"(4)")],-1)),e("div",Nt,[y(e("select",{id:"section",ref_key:"sectionRef",ref:M,"onUpdate:modelValue":t[5]||(t[5]=r=>s.section=r),class:"input focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},[t[15]||(t[15]=e("option",{value:null},"None",-1)),(o(!0),l(_,null,F(N.value,r=>(o(),l("option",{key:r.id,value:r.id},d(r.title),9,St))),128))],512),[[st,s.section]])])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[i(" Tags "),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"(5)")],-1)),e("div",At,[(o(!0),l(_,null,F(p.value,(r,v)=>(o(),l("div",{key:r.id,onClick:jt=>V(r),class:lt(["px-3 py-1 rounded-full text-sm cursor-pointer",s.tag_ids.includes(r.id)?"text-white":"text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700"]),style:ot(s.tag_ids.includes(r.id)?{backgroundColor:r.color}:{})},[i(d(r.name)+" ",1),e("span",Mt,d(v<9?`(${v+6})`:""),1)],14,Tt))),128))])]),e("div",Bt,[e("div",Lt,[y(e("input",{id:"is_favorite","onUpdate:modelValue":t[6]||(t[6]=r=>s.is_favorite=r),type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[z,s.is_favorite]]),t[18]||(t[18]=e("label",{for:"is_favorite",class:"ml-2 block text-sm text-gray-900 dark:text-white"},[i(" Mark as favorite "),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"(F)")],-1))]),e("div",Rt,[y(e("input",{id:"is_archived","onUpdate:modelValue":t[7]||(t[7]=r=>s.is_archived=r),type:"checkbox",class:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[z,s.is_archived]]),t[19]||(t[19]=e("label",{for:"is_archived",class:"ml-2 block text-sm text-gray-900 dark:text-white"},[i(" Archive flashcard "),e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"(A)")],-1))])]),e("div",Dt,[e("div",null,[u.value?(o(),l("button",{key:0,type:"button",onClick:B,class:"px-3 py-1.5 text-sm bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-700 rounded hover:bg-gray-50 dark:hover:bg-gray-700"},t[20]||(t[20]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5 mr-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})]),i(" Previous ")],-1)]))):w("",!0)]),e("div",Vt,[e("button",{type:"button",onClick:t[8]||(t[8]=r=>b(m).back()),class:"btn bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}," Cancel "),e("button",{type:"submit",class:"btn-primary",disabled:b(f).loading},[b(f).loading?(o(),l("span",Pt,t[21]||(t[21]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),i(" Saving... ")]))):(o(),l("span",Ut,[i(d(u.value?"Update Flashcard":"Create Flashcard")+" ",1),t[22]||(t[22]=e("span",{class:"text-xs opacity-80"},"(Ctrl+Enter)",-1))]))],8,$t)]),e("div",null,[u.value?(o(),l("button",{key:0,type:"button",onClick:L,class:"px-3 py-1.5 text-sm bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-700 rounded hover:bg-gray-50 dark:hover:bg-gray-700"},t[23]||(t[23]=[e("span",{class:"flex items-center"},[i(" Next "),e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3.5 w-3.5 ml-1",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})])],-1)]))):w("",!0)])])],32)]))]),_:1},8,["title"]))}},Ot=Q(zt,[["__scopeId","data-v-d288417d"]]);export{Ot as default};
